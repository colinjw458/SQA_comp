# Real-time Machine Learning Stock Portfolio Selection

This project demonstrates a sophisticated approach to stock portfolio management using real-time data processing and reinforcement learning. It leverages CSP (Composable Stream Processing) for handling asynchronous data and employs Q-learning for dynamic portfolio rebalancing.

## Key Features

### 1. Real-time Data Processing with CSP

The system is designed to handle real-time, asynchronous market data using CSP. While the current implementation uses historical data for simulation purposes, it can be easily adapted to process live market feeds with minimal code changes. This flexibility allows for seamless transition between backtesting and live trading environments.

### 2. Daily Portfolio Rebalancing

The model is structured to:

- Train on a specified number of steps (n) at the beginning of each trading day
- Utilize the trained model to manage the portfolio for the remainder of the day
- Rebalance the portfolio daily

This approach assumes zero transaction costs, making it ideal for high-frequency rebalancing strategies. In real-world applications, transaction costs would need to be factored in for optimal performance.

### 3. Q-Learning Reinforcement Learning

At the core of the decision-making process is a Q-learning reinforcement learning model:

- The model learns to make optimal trading decisions by interacting with the market environment
- It uses a Deep Q-Network (DQN) to approximate the Q-function
- The agent's goal is to maximize cumulative rewards, which are based on portfolio returns and risk-adjusted metrics like the Sharpe ratio

## Sample Output

Below is an example of the portfolio performance graph generated by the model:

![Portfolio Performance](/images/Figure_1.png)

This graph illustrates the training phase, where multiple portfolios are evaluated, followed by the testing phase where the best-performing portfolio is used.

## Getting Started

### How to Run the Portfolio Manager

Follow these steps to set up and run the portfolio_manager.py file:

1. **Set up a Python environment:**
   It's recommended to use a virtual environment to avoid conflicts with other projects. You can create one using:

   ```
   python -m venv portfolio_env
   ```

2. **Activate the virtual environment:**

   - On Windows:
     ```
     portfolio_env/Scripts/activate
     ```
   - On macOS and Linux:
     ```
     source portfolio_env/bin/activate
     ```

3. **Install the required dependencies:**
   With the virtual environment activated, use pip to install the dependencies listed in requirements.txt:

   ```
   pip install -r requirements.txt
   ```

   This will install all necessary packages, including numpy, pandas, matplotlib, tensorflow, csp, and tqdm.

4. **Prepare your data:**
   Ensure that your "HistoricalEquityData.csv" file is in the same directory as portfolio_manager.py.

5. **Run the portfolio manager:**
   Execute the portfolio_manager.py script:

   ```
   python portfolio_manager.py
   ```

6. **View the results:**
   The script will run the simulation, display a progress bar, and then show a plot of the portfolio performance. It will also print out key metrics like final portfolio value, total return, and Sharpe ratio.

### Troubleshooting

- If you encounter any "module not found" errors, ensure that all dependencies were installed correctly in step 3.
- Make sure your Python version is compatible with the requirements. This project is typically tested with Python 3.7+.
- If you face issues with the CSP library, you might need to install it separately or check for any specific installation instructions on its repository.

### Notes

- The simulation may take some time to run, especially for large datasets. The progress bar will keep you informed of the simulation's progress.
- You can adjust parameters like INITIAL_BALANCE and TRAINING_STEPS in the portfolio_manager.py file to experiment with different scenarios.
- Remember that this simulation assumes zero transaction costs. In a real-world scenario, you would need to account for these costs.

## Dependencies

- numpy
- pandas
- matplotlib
- tensorflow
- csp
- tqdm

## Potential Improvements

- Integration with live market data feeds
- Incorporation of transaction costs for more realistic simulations
- Enhanced feature engineering for improved model performance

## Contributors

Colin White:
https://github.com/colinjw458
https://www.linkedin.com/in/colin-white-b66413189/

Mackenzie Qu:
https://github.com/mackenziequ
